<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Form Nhập Liệu Hàng Ngày</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 900px;
            margin: 50px auto;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            padding: 20px;
        }
        h1 {
            text-align: center;
            color: #333;
        }
        label {
            font-weight: bold;
            margin-top: 10px;
            display: block;
        }
        input, select, button {
            width: 100%;
            padding: 10px;
            margin-top: 5px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: center;
        }
        th {
            background-color: #007bff;
            color: white;
        }
        .submit-btn {
            background-color: #28a745;
            color: white;
            font-size: 18px;
            border: none;
            cursor: pointer;
        }
        .submit-btn:hover {
            background-color: #218838;
        }
        #submitStatus {
            text-align: center;
            margin-top: 10px;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Form Nhập Liệu Hàng Ngày</h1>
        <form id="inputForm">
            <label for="date">Ngày nhập liệu:</label>
            <input type="date" id="date" required>

            <label for="store">Cửa hàng:</label>
            <select id="store" required>
                <option value="">-- Chọn cửa hàng --</option>
                <option value="40 LVH">40 LVH</option>
                <option value="91 LVH">91 LVH</option>
                <option value="313 LVH">313 LVH</option>
                <option value="23 MĐC">23 MĐC</option>
                <option value="276 TĐN">276 TĐN</option>
                <option value="607 TĐN">607 TĐN</option>
                <option value="1066 TĐN">1066 TĐN</option>
                <option value="433 TTĐ">433 TTĐ</option>
                <option value="01 LLQ">01 LLQ</option>
                <option value="44 NTT">44 NTT</option>
                <option value="676 HBT">676 HBT</option>
                <option value="245 OIĐ">245 OIĐ</option>
                <option value="155 LĐH">155 LĐH</option>
                <option value="16 PĐL">16 PĐL</option>
                <option value="110 DSTK">110 DSTK</option>
                <option value="05 NTN">05 NTN</option>
                <option value="85 NC">85 NC</option>
                <option value="119 HHT">119 HHT</option>
                <option value="141 QT">141 QT</option>
                <option value="59 VĐ">59 VĐ</option>
                <option value="605 NQ">605 NQ</option>
                <option value="47 NVT">47 NVT</option>
                <option value="207 CTVT">207 CTVT</option>
                <option value="118 NHS">118 NHS</option>
                <option value="61 CD">61 CD</option>
            </select>

            <table>
                <thead>
                    <tr>
                        <th>STT</th>
                        <th>Tên sản phẩm</th>
                        <th>Số lượng</th>
                    </tr>
                </thead>
                <tbody id="productTable">
                    <!-- Sẽ được điền động bằng JavaScript -->
                </tbody>
            </table>

            <div id="submitStatus"></div>
            <button type="submit" class="submit-btn">Lưu Dữ Liệu</button>
        </form>
    </div>

    <script>
        // Danh sách sản phẩm
        const products = [
            "Xúc xích", "Chà bông kẹp", "Pate trứng cút", "SW mặn", "Dăm bông trứng", 
            "Chà bông thịt", "Bông lúa", "Xúc xích Đức", "PIZZA", "Chiên xù", 
            "Pho mai que", "Bánh cua", "Hotdog dâu", "Bánh gấu", "Mehico", 
            "Dứa đường", "Phi mè", "Dừa lưới", "Donut đường", "BÁnh ong", 
            "Quế", "Chiên đường", "Tròn dừa", "Paparoty", "Hambogo", 
            "Donus", "Donut hạnh nhân", "Donut mini", "Sừng trâu", "Sừng trâu TM", 
            "Nho dừa", "Nho dài", "Hồ lô", "Pho mai bắp", "Ốc sô", 
            "Cuộn nho", "Hạnh nhân", "Pateso", "Xếp thịt", "Xoắn đường", 
            "Bánh mặn", "Bánh ngọt", "Sừng trâu SÔ", "Nhân sữa cacao", "Đx sầu riêng", 
            "Mè đen", "Hambogo mini", "Hộp DONUS", "Nho dài"
        ];

        // Điền sản phẩm vào bảng
        const productTable = document.getElementById('productTable');
        products.forEach((product, index) => {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td>${index + 1}</td>
                <td>${product}</td>
                <td><input type="number" name="product_${index}" min="0" placeholder="0"></td>
            `;
            productTable.appendChild(row);
        });

        // Xử lý gửi biểu mẫu
        document.getElementById('inputForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const submitStatus = document.getElementById('submitStatus');
            submitStatus.textContent = 'Đang gửi...';

            // Thu thập dữ liệu
            const formData = new FormData(e.target);
            const date = formData.get('date');
            const store = formData.get('store');

            // Thu thập số lượng sản phẩm
            const productQuantities = products.map((product, index) => 
                parseInt(formData.get(`product_${index}`) || 0)
            );

            try {
                const response = await fetch('https://script.google.com/macros/s/AKfycbyQBI2AdldFfnzaa_GCFjEfanoceWHlMrZElVaFiniFocPQNlvQVrxNoCXZPWAjlL0/exec', {
                    method: 'POST',
                    mode: 'no-cors', // Google Apps Script yêu cầu no-cors
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded'
                    },
                    body: new URLSearchParams({
                        date: date,
                        store: store,
                        products: JSON.stringify(products),
                        quantities: JSON.stringify(productQuantities)
                    })
                });

                submitStatus.textContent = 'Đã gửi thành công!';
                submitStatus.style.color = 'green';
                e.target.reset(); // Đặt lại biểu mẫu
            } catch (error) {
                submitStatus.textContent = 'Lỗi khi gửi dữ liệu!';
                submitStatus.style.color = 'red';
                console.error('Error:', error);
            }
        });
    </script>
</body>
</html>
